"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;
var _bcryptjs = _interopRequireDefault(require("bcryptjs"));
var _jsonwebtoken = _interopRequireDefault(require("jsonwebtoken"));
require("dotenv/config");
function generateToken(id) {
  return _jsonwebtoken["default"].sign({
    id: id
  }, process.env.JWT_SECRET, {
    expiresIn: '30d'
  });
}
function hashpassword(password) {
  return _bcryptjs["default"].hashSync(password, 10);
}
function comparePassword(password, hashedPassword) {
  return _bcryptjs["default"].compareSync(password, hashedPassword);
}
function generatePassword() {
  var pass = '';
  var str = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ' + 'abcdefghijklmnopqrstuvwxyz' + '1234567890' + '!@#$%^&()_+~`|}{[]:;?><,./-=';
  for (var i = 1; i <= 16; i++) {
    var _char = Math.floor(Math.random() * str.length + 1);
    pass += str.charAt(_char);
  }
  return pass;
}
var _default = {
  generateToken: generateToken,
  hashpassword: hashpassword,
  comparePassword: comparePassword,
  generatePassword: generatePassword
};
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfYmNyeXB0anMiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9qc29ud2VidG9rZW4iLCJnZW5lcmF0ZVRva2VuIiwiaWQiLCJqd3QiLCJzaWduIiwicHJvY2VzcyIsImVudiIsIkpXVF9TRUNSRVQiLCJleHBpcmVzSW4iLCJoYXNocGFzc3dvcmQiLCJwYXNzd29yZCIsImJjcnlwdCIsImhhc2hTeW5jIiwiY29tcGFyZVBhc3N3b3JkIiwiaGFzaGVkUGFzc3dvcmQiLCJjb21wYXJlU3luYyIsImdlbmVyYXRlUGFzc3dvcmQiLCJwYXNzIiwic3RyIiwiaSIsImNoYXIiLCJNYXRoIiwiZmxvb3IiLCJyYW5kb20iLCJsZW5ndGgiLCJjaGFyQXQiLCJfZGVmYXVsdCIsImV4cG9ydHMiXSwic291cmNlcyI6WyIuLi8uLi9zcmMvaGVscGVycy9hdXRoZW50aWNhdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgYmNyeXB0IGZyb20gXCJiY3J5cHRqc1wiO1xyXG5pbXBvcnQgand0IGZyb20gXCJqc29ud2VidG9rZW5cIjtcclxuaW1wb3J0IHt9IGZyb20gXCJkb3RlbnYvY29uZmlnXCI7XHJcblxyXG4gICAgIGZ1bmN0aW9uIGdlbmVyYXRlVG9rZW4gIChpZCkgIHtcclxuICAgIHJldHVybiBqd3Quc2lnbih7IGlkIH0sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQsIHsgZXhwaXJlc0luOiAnMzBkJyB9KTtcclxuICAgIH1cclxuICAgIFxyXG5cclxuICAgZnVuY3Rpb24gaGFzaHBhc3N3b3JkKHBhc3N3b3JkKXtcclxuICAgICAgICByZXR1cm4gYmNyeXB0Lmhhc2hTeW5jKHBhc3N3b3JkLDEwKVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGNvbXBhcmVQYXNzd29yZChwYXNzd29yZCwgaGFzaGVkUGFzc3dvcmQpe1xyXG4gICAgICAgIHJldHVybiBiY3J5cHQuY29tcGFyZVN5bmMocGFzc3dvcmQsIGhhc2hlZFBhc3N3b3JkKVxyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGdlbmVyYXRlUGFzc3dvcmQgICgpICB7XHJcbiAgICB2YXIgcGFzcyA9ICcnO1xyXG4gICAgdmFyIHN0ciA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWicgKyAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXonICsgJzEyMzQ1Njc4OTAnICsgJyFAIyQlXiYoKV8rfmB8fXtbXTo7Pz48LC4vLT0nO1xyXG4gICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gMTY7IGkrKykge1xyXG4gICAgICB2YXIgY2hhciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHN0ci5sZW5ndGggKyAxKTtcclxuICAgICAgcGFzcyArPSBzdHIuY2hhckF0KGNoYXIpXHJcbiAgICB9XHJcbiAgICByZXR1cm4gcGFzcztcclxuICBcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQge2dlbmVyYXRlVG9rZW4saGFzaHBhc3N3b3JkLGNvbXBhcmVQYXNzd29yZCxnZW5lcmF0ZVBhc3N3b3JkfVxyXG5cclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUEsSUFBQUEsU0FBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0FBQ0EsSUFBQUMsYUFBQSxHQUFBRixzQkFBQSxDQUFBQyxPQUFBO0FBQ0FBLE9BQUE7QUFFSyxTQUFTRSxhQUFhQSxDQUFHQyxFQUFFLEVBQUc7RUFDL0IsT0FBT0Msd0JBQUcsQ0FBQ0MsSUFBSSxDQUFDO0lBQUVGLEVBQUUsRUFBRkE7RUFBRyxDQUFDLEVBQUVHLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVLEVBQUU7SUFBRUMsU0FBUyxFQUFFO0VBQU0sQ0FBQyxDQUFDO0FBQ3JFO0FBR0QsU0FBU0MsWUFBWUEsQ0FBQ0MsUUFBUSxFQUFDO0VBQzFCLE9BQU9DLG9CQUFNLENBQUNDLFFBQVEsQ0FBQ0YsUUFBUSxFQUFDLEVBQUUsQ0FBQztBQUN2QztBQUVBLFNBQVNHLGVBQWVBLENBQUNILFFBQVEsRUFBRUksY0FBYyxFQUFDO0VBQzlDLE9BQU9ILG9CQUFNLENBQUNJLFdBQVcsQ0FBQ0wsUUFBUSxFQUFFSSxjQUFjLENBQUM7QUFDdkQ7QUFFQSxTQUFTRSxnQkFBZ0JBLENBQUEsRUFBTTtFQUMvQixJQUFJQyxJQUFJLEdBQUcsRUFBRTtFQUNiLElBQUlDLEdBQUcsR0FBRyw0QkFBNEIsR0FBRyw0QkFBNEIsR0FBRyxZQUFZLEdBQUcsOEJBQThCO0VBQ3JILEtBQUssSUFBSUMsQ0FBQyxHQUFHLENBQUMsRUFBRUEsQ0FBQyxJQUFJLEVBQUUsRUFBRUEsQ0FBQyxFQUFFLEVBQUU7SUFDNUIsSUFBSUMsS0FBSSxHQUFHQyxJQUFJLENBQUNDLEtBQUssQ0FBQ0QsSUFBSSxDQUFDRSxNQUFNLEVBQUUsR0FBR0wsR0FBRyxDQUFDTSxNQUFNLEdBQUcsQ0FBQyxDQUFDO0lBQ3JEUCxJQUFJLElBQUlDLEdBQUcsQ0FBQ08sTUFBTSxDQUFDTCxLQUFJLENBQUM7RUFDMUI7RUFDQSxPQUFPSCxJQUFJO0FBRWY7QUFBQyxJQUFBUyxRQUFBLEdBRWM7RUFBQ3pCLGFBQWEsRUFBYkEsYUFBYTtFQUFDUSxZQUFZLEVBQVpBLFlBQVk7RUFBQ0ksZUFBZSxFQUFmQSxlQUFlO0VBQUNHLGdCQUFnQixFQUFoQkE7QUFBZ0IsQ0FBQztBQUFBVyxPQUFBLGNBQUFELFFBQUEifQ==